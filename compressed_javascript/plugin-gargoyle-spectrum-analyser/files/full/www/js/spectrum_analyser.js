var spectrum=new Object;var interfaces;var freq_low;var freq_high;var detected;var band;var plotdata=[];var gband=[[1,2,3,4,5,6,7,8,9,10,11,12,13,14],[2.412,2.417,2.422,2.427,2.432,2.437,2.442,2.447,2.452,2.457,2.462,2.467,2.472,2.484],[2.401,2.406,2.411,2.416,2.421,2.426,2.431,2.436,2.441,2.446,2.451,2.456,2.461,2.473],[2.423,2.428,2.433,2.438,2.443,2.448,2.453,2.458,2.463,2.468,2.473,2.478,2.483,2.495]];var aband=[[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,144,149,153,157,161,165],[5.18,5.2,5.22,5.24,5.26,5.28,5.3,5.32,5.5,5.52,5.54,5.56,5.58,5.6,5.62,5.64,5.66,5.68,5.7,5.72,5.745,5.765,5.785,5.805,5.825],[5.17,5.19,5.21,5.23,5.25,5.27,5.29,5.31,5.49,5.51,5.53,5.55,5.57,5.59,5.61,5.63,5.65,5.67,5.69,5.71,5.735,5.755,5.775,5.795,5.815],[5.19,5.21,5.23,5.25,5.27,5.29,5.31,5.33,5.51,5.53,5.55,5.57,5.59,5.61,5.63,5.65,5.67,5.69,5.71,5.73,5.755,5.775,5.795,5.815,5.835]];function initialiseAll(){var ivalues=[];var inames=[];interfaces=parseInterfaces(wifiLines);if(interfaces!=-1){for(var x=0;x<interfaces.length;x++){ivalues.push(interfaces[x][0]);inames.push(interfaces[x][1])}setAllowableSelections("interface",ivalues,inames);initialisePlots();getWifiData()}else{document.getElementById("interface").disabled=true}}function initialisePlots(){band=interfaces[document.getElementById("interface").selectedIndex][1];if(band=="2.4GHz"){freq_low=2.4;freq_high=2.5}else{freq_low=5.165;freq_high=5.84}}function changeBand(){initialisePlots();getWifiData()}function parseInterfaces(lines){if(lines.length==0){return-1}var interfaceData=[];lineIndex=0;for(lineIndex=0;lineIndex<lines.length;lineIndex++){var nextLine=lines[lineIndex];var wlan=nextLine.split(" ");var guest=wlan[0].indexOf("-");if(guest!=-1){continue}var interfaceid=wlan[0];if(wlan[1]>14){var interfaceband="5GHz"}else{var interfaceband="2.4GHz"}interfaceData.push([interfaceid,interfaceband])}return interfaceData}function getWifiData(){var Commands=[];var parsedWifiData=[];var selectedband=interfaces[document.getElementById("interface").selectedIndex][0];Commands.push("iw "+selectedband+' scan 2>&1 | awk -F\'\\\n\' \'{print "\\""$0"\\"" }\'');var param=getParameterDefinition("commands",Commands.join("\n"))+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,""));var stateChangeFunction=function(req){if(req.readyState==4){var shell_output=req.responseText.replace(/Success/,"");shell_output=shell_output.replace(/\"/g,"");parsedWifiData=parseWifiData(shell_output);if(parsedWifiData==-1){alert(spectrum.Noscan);d3.select("svg").remove();document.getElementById("table-container-row").style.display="none";plotdata=[];window.removeEventListener("resize",plotall)}else{generateGraphData(parsedWifiData);generateTableData(parsedWifiData)}}};runAjax("POST","utility/run_commands.sh",param,stateChangeFunction)}function parseWifiData(rawScanOutput){if(rawScanOutput!=null&&rawScanOutput.indexOf("\n")!=0&&rawScanOutput.indexOf("\r")!=0&&rawScanOutput.match(/command failed: Resource busy/g)==null){var parsed=[[],[],[],[],[],[],[],[],[],[]];function splitStringWithException(str,toMatch,Exceptions){var retval=[];var toMatchLength=toMatch.length;var indexMatches=[];var match,i=0;while((match=str.indexOf(toMatch,i))>-1){indexMatches.push(match);i=match+toMatchLength}var x,y=0;for(x=0;x<indexMatches.length;x++){for(y=0;y<Exceptions.length;y++){if(indexMatches[x]>0){if(str.charAt(indexMatches[x]-1)==Exceptions[y]){indexMatches.splice(x,1)}}}}for(x=0;x<indexMatches.length;x++){if(x<indexMatches.length-1){retval.push(str.substring(indexMatches[x],indexMatches[x+1]-1))}else{retval.push(str.substring(indexMatches[x]))}}return retval}var stringSplit="BSS";var exceptions=["I","Q"];var cells=splitStringWithException(rawScanOutput,stringSplit,exceptions);var getCellValues=function(id,cellLines){var vals=[];var lineIndex;for(lineIndex=0;lineIndex<cellLines.length;lineIndex++){var line=cellLines[lineIndex];var idIndex=line.indexOf(id);var cIndex=line.indexOf(":");var eqIndex=line.indexOf("=");var splitIndex=cIndex;if(splitIndex<0||eqIndex>=0&&eqIndex<splitIndex){splitIndex=eqIndex}if(idIndex>=0&&splitIndex>idIndex){var val=line.substr(splitIndex+1);val=val.replace(/^[^\"]*\"/g,"");val=val.replace(/\".*$/g,"");val=val.replace(/^[ ]/g,"");val=val.replace(/ dBm/g,"");val=val.replace(/channel /g,"");vals.push(val)}if(id=="BSSID"){var pat=/([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})/g;if(pat.test(line)==true){splitIndex=line.lastIndexOf(":");var val=line.substr(0,splitIndex+3);val=val.replace(/ /g,"");val=val.replace(/BSS/g,"");vals.push(val)}}}return vals};while(cells.length>0){var cellData=cells.shift();var cellLines=cellData.split(/[\r\n]+/);var htmode=0;var vhtmode=0;var bssid=getCellValues("BSSID",cellLines).shift();var ssid=getCellValues("SSID",cellLines).shift();var sigStr=getCellValues("signal",cellLines).shift();if(getCellValues("* primary channel",cellLines).shift()){var prichannel=getCellValues("* primary channel",cellLines).shift();var secchannel=getCellValues("secondary channel offset",cellLines).shift();htmode=1}else{var prichannel=getCellValues("freq",cellLines).shift()/1e3;if(band=="2.4GHz"){prichannel=gband[1].indexOf(prichannel);prichannel=gband[0][prichannel].toString()}else{prichannel=aband[1].indexOf(prichannel);prichannel=aband[0][prichannel].toString()}}if(getCellValues("* channel width",cellLines).shift()){var vhtwidth=getCellValues("* channel width",cellLines).shift();var vhtseg1=getCellValues("* center freq segment 1",cellLines).shift();var vhtseg2=getCellValues("* center freq segment 2",cellLines).shift();vhtmode=1}if(!secchannel){secchannel="no secondary"}if(ssid!=null&&prichannel!=null&&secchannel!=null&&sigStr!=null&&bssid!=null){parsed[0].push(ssid);parsed[1].push(prichannel);parsed[2].push(secchannel);parsed[3].push(sigStr);parsed[4].push(vhtwidth);parsed[5].push(vhtseg1);parsed[6].push(vhtseg2);parsed[7].push(bssid);parsed[8].push(htmode);parsed[9].push(vhtmode)}}for(x=0;x<parsed[7].length;x++){append=2;for(y=x+1;y<parsed[7].length;y++){if(parsed[7][x]==parsed[7][y]){parsed[7][y]=parsed[7][y]+"_"+append;append+=1}}if(append>2){parsed[7][x]=parsed[7][x]+"_1"}}return parsed}else{return-1}}function generateGraphData(detected){plotdata=[];var freqoffset=.001;var htoffset=4;var vhtoffset=12;var x,y=0;for(x=0;x<detected[0].length;x++){var SSID=detected[0][x];var channel=detected[1][x];var secondary=detected[2][x];var level=detected[3][x];var vhtwidth=detected[4][x];var vhtseg1=detected[5][x];var vhtseg2=detected[6][x]==0?null:detected[6][x];var BSSID=detected[7][x].replace(/:/g,"");if(band=="2.4GHz"){if(secondary=="no secondary"){plotdata[x*4]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,2)};plotdata[x*4+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,2)+freqoffset};plotdata[x*4+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,3)-freqoffset};plotdata[x*4+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,3)}}else if(secondary=="above"){plotdata[x*4]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,2)};plotdata[x*4+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,2)+freqoffset};plotdata[x*4+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel- -htoffset,3)-freqoffset};plotdata[x*4+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel- -htoffset,3)}}else if(secondary=="below"){plotdata[x*4]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel-htoffset,2)};plotdata[x*4+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel-htoffset,2)+freqoffset};plotdata[x*4+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,3)-freqoffset};plotdata[x*4+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,3)}}}else if(band=="5GHz"){y=plotdata.length;if(secondary=="no secondary"){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,3)}}else if(secondary=="above"){if(!vhtwidth){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel- -htoffset,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel- -htoffset,3)}}else{if(!vhtseg2){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1- -.5*vhtoffset,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1- -.5*vhtoffset,3)}}else if(Math.abs(vhtseg1-vhtseg2)==8){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-(2+vhtoffset),2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-(2+vhtoffset),2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-(-2-vhtoffset),3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-(-2-vhtoffset),3)}}else{plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset- -vhtoffset,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset- -vhtoffset,3)};plotdata[y+4]={bssid:BSSID,ssid:SSID,level:undefined,freq:getfreqData(vhtseg1,3)};plotdata[y+5]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-.5*vhtoffset,2)};plotdata[y+6]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-.5*vhtoffset,2)+freqoffset};plotdata[y+7]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-.5*vhtoffset- -vhtoffset,3)-freqoffset};plotdata[y+8]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-.5*vhtoffset- -vhtoffset,3)}}}}else if(secondary=="below"){if(!vhtwidth){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel-htoffset,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel-htoffset,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(channel,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(channel,3)}}else{if(!vhtseg2){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1- -.5*vhtoffset,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1- -.5*vhtoffset,3)}}else if(Math.abs(vhtseg1-vhtseg2)==8){plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-(2+vhtoffset),2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-(2+vhtoffset),2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-(-2-vhtoffset),3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-(-2-vhtoffset),3)}}else{plotdata[y]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset,2)};plotdata[y+1]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset,2)+freqoffset};plotdata[y+2]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg1-.5*vhtoffset- -vhtoffset,3)-freqoffset};plotdata[y+3]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg1-.5*vhtoffset- -vhtoffset,3)};plotdata[y+4]={bssid:BSSID,ssid:SSID,level:undefined,freq:getfreqData(vhtseg1,3)};plotdata[y+5]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-.5*vhtoffset,2)};plotdata[y+6]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-.5*vhtoffset,2)+freqoffset};plotdata[y+7]={bssid:BSSID,ssid:SSID,level:level,freq:getfreqData(vhtseg2-.5*vhtoffset- -vhtoffset,3)-freqoffset};plotdata[y+8]={bssid:BSSID,ssid:SSID,level:"-100",freq:getfreqData(vhtseg2-.5*vhtoffset- -vhtoffset,3)}}}}}else{plotdata=-1}}plotall();window.addEventListener("resize",plotall)}function generateTableData(detected){var x=0;var htoffset=4;var vhtoffset=12;var columnNames=[spectrum.SSID,spectrum.BSSID,spectrum.Channel,spectrum.Width,spectrum.Mode,spectrum.Signal];var TableData=new Array;for(x=0;x<detected[0].length;x++){var SSID=detected[0][x];var channel=detected[1][x];var secondary=detected[2][x];var level=detected[3][x];var vhtwidth=detected[4][x];var vhtseg1=detected[5][x];var vhtseg2=detected[6][x]==0?null:detected[6][x];var BSSID=detected[7][x].toUpperCase();var htmode=detected[8][x];var vhtmode=detected[9][x];if(band=="2.4GHz"){if(secondary=="no secondary"){TableData.push([SSID,BSSID,channel,"20MHz",htmode?"b,g,n":"b,g",level+"dBm"])}else if(secondary=="above"){TableData.push([SSID,BSSID,channel+"-"+(channel- -htoffset),"40MHz","b,g,n",level+"dBm"])}else if(secondary=="below"){TableData.push([SSID,BSSID,channel+"-"+(channel-htoffset),"40MHz","b,g,n",level+"dBm"])}}else if(band=="5GHz"){if(secondary=="no secondary"){TableData.push([SSID,BSSID,channel,"20MHz",htmode?vhtmode?"a,n,ac":"a,n":"a",level+"dBm"])}else if(secondary=="above"){if(!vhtwidth){TableData.push([SSID,BSSID,channel+"-"+(channel- -htoffset),"40MHz",vhtmode?"a,n,ac":"a,n",level+"dBm"])}else{if(!vhtseg2){TableData.push([SSID,BSSID,vhtseg1-.5*vhtoffset+"-"+(vhtseg1- -.5*vhtoffset),"80MHz","n,ac",level+"dBm"])}else if(Math.abs(vhtseg1-vhtseg2)==8){TableData.push([SSID,BSSID,vhtseg2-(2+vhtoffset)+"-"+(vhtseg2-(-2-vhtoffset)),"160MHz","n,ac",level+"dBm"])}else{TableData.push([SSID,BSSID,vhtseg1-.5*vhtoffset+"-"+(vhtseg1- -.5*vhtoffset)+","+(vhtseg2-.5*vhtoffset+"-"+(vhtseg2- -.5*vhtoffset)),"80+80MHz","n,ac",level+"dBm"])}}}else if(secondary=="below"){if(!vhtwidth){TableData.push([SSID,BSSID,channel+"-"+(channel-htoffset),"40MHz",vhtmode?"a,n,ac":"a,n",level+"dBm"])}else{if(!vhtseg2){TableData.push([SSID,BSSID,vhtseg1-.5*vhtoffset+"-"+(vhtseg1- -.5*vhtoffset),"80MHz","n,ac",level+"dBm"])}else if(Math.abs(vhtseg1-vhtseg2)==8){TableData.push([SSID,BSSID,vhtseg2-(2+vhtoffset)+"-"+(vhtseg2-(-2-vhtoffset)),"160MHz","n,ac",level+"dBm"])}else{TableData.push([SSID,BSSID,vhtseg1-.5*vhtoffset+"-"+(vhtseg1- -.5*vhtoffset)+","+(vhtseg2-.5*vhtoffset+"-"+(vhtseg2- -.5*vhtoffset)),"80+80MHz","n,ac",level+"dBm"])}}}}else{}}var Table=createTable(columnNames,TableData,"spectrum_table",false,false);var tableContainer=document.getElementById("spectrum_table_container");if(tableContainer.firstChild!=null){tableContainer.removeChild(tableContainer.firstChild)}tableContainer.appendChild(Table);document.getElementById("table-container-row").style.display="block"}function getfreqData(channel,info){if(channel>14){a=aband[0].indexOf(parseInt(channel));return aband[info][a]}else{a=gband[0].indexOf(parseInt(channel));return gband[info][a]}}function plotall(){if(plotdata.length==0){return-1}var MARGINS={},HEIGHT,WIDTH,LEGENDOFFSET;LEGENDOFFSET=30;function updateDimensions(winWidth){MARGINS.top=20;MARGINS.right=10;MARGINS.left=45;MARGINS.bottom=50;WIDTH=winWidth-MARGINS.left-MARGINS.right;HEIGHT=winWidth*.8-MARGINS.top-MARGINS.bottom}d3.select("svg").remove();var maxsig=-150;for(x=0;x<plotdata.length;x++){if(plotdata[x].level>maxsig){maxsig=plotdata[x].level- -10}}if(maxsig>0){maxsig=0}var dataGroup=d3.nest().key(function(d){return d.bssid}).entries(plotdata);var chartcontainerwidth=document.getElementById("spectrum_plot").offsetWidth;updateDimensions(chartcontainerwidth);var spect=d3.select("#spectrum_plot").append("svg"),lSpace=WIDTH/dataGroup.length;xScale=d3.scale.linear().range([MARGINS.left,WIDTH-MARGINS.right]).domain([freq_low,freq_high]),yScale=d3.scale.linear().range([HEIGHT-MARGINS.bottom,MARGINS.top+LEGENDOFFSET]).domain([-100,maxsig]),xAxis=d3.svg.axis().scale(xScale),yAxis=d3.svg.axis().scale(yScale);spect.attr("width",WIDTH+MARGINS.right+MARGINS.left).attr("height",HEIGHT+MARGINS.top+MARGINS.bottom);xAxis=d3.svg.axis("xaxis").scale(xScale).tickValues(function(d){if(band=="2.4GHz"){return gband[1]}else{return aband[1]}}).tickFormat(function(d){if(band=="2.4GHz"){a=gband[1].indexOf(d);return gband[0][a]}else{a=aband[1].indexOf(d);return aband[0][a]}}),yAxis=d3.svg.axis("yaxis").scale(yScale).orient("left");if(band=="2.4GHz"){spect.append("svg:g").attr("class","axis").attr("transform","translate(0,"+(HEIGHT-LEGENDOFFSET-MARGINS.bottom)+")").call(xAxis)}else{spect.append("svg:g").attr("class","axis").attr("transform","translate(0,"+(HEIGHT-LEGENDOFFSET-MARGINS.bottom)+")").call(xAxis).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy","-.3em").attr("transform","rotate(-90)")}spect.append("svg:g").attr("class","axis").attr("transform","translate("+MARGINS.left+","+-LEGENDOFFSET+")").call(yAxis);var lineGen=d3.svg.line().defined(function(d){return d.level!=null&&d.level!=undefined}).x(function(d){return xScale(d.freq)}).y(function(d){return yScale(d.level)});dataGroup.forEach(function(d,i){randcolour="hsl("+60*i+",100%,50%)";legendmarkersize=10;spect.append("svg:path").attr("class","gline").attr("id","tag"+d.key.replace(/\s+/g,"")).attr("d",lineGen(d.values)).attr("stroke",randcolour).attr("stroke-width",2).attr("fill","none").attr("transform","translate(0,"+-LEGENDOFFSET+")");spect.append("rect").attr("width",legendmarkersize).attr("height",legendmarkersize).attr("x",lSpace/2+i*lSpace).attr("y",HEIGHT-legendmarkersize-LEGENDOFFSET).style("fill",randcolour).style("stroke",randcolour).on("mouseover",function(){var existingcolour=d3.select("#tag"+d.key.replace(/\s+/g,"")).style("stroke");d3.select("#tag"+d.key.replace(/\s+/g,"")).style("fill",existingcolour)}).on("mouseout",function(){d3.select("#tag"+d.key.replace(/\s+/g,"")).style("fill","none").style("opacity",1)});spect.append("text").style("fill","black").style("text-anchor","end").attr("transform","translate("+(lSpace/2+i*lSpace+legendmarkersize/2)+","+(HEIGHT-LEGENDOFFSET+legendmarkersize)+") rotate(-65)").text(d.values[0].ssid)})}
